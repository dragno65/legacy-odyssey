<section id="page-family" class="page-section">
  <div class="page-header">
    <div class="page-header-eyebrow">Chapter Five</div>
    <h2 class="page-header-title"><em>Our</em> Family</h2>
    <p class="page-header-sub">The people who loved your child before they even had a name.</p>
  </div>
  <div class="family-intro">
    <div class="family-tree-label">The People Who Make Up Your World</div>
    <p class="family-tree-sub">Every person in this section is someone whose life changed the day you were born. They come from different places, carry different stories, and together they form the village that will help raise you.</p>
  </div>

  <%
    const members = familyMembers || [];
    const parents = members.filter(fm => fm.member_key === 'mom' || fm.member_key === 'dad');
    const grandparents = members.filter(fm => fm.member_key !== 'mom' && fm.member_key !== 'dad');
  %>

  <% if (parents.length) { %>
    <div class="family-section-title">&#10022; Mom &amp; Dad</div>
    <div class="family-cards">
      <% parents.forEach(fm => { %>
        <div class="family-card" onclick="openFamilyDetail('<%= fm.member_key %>')">
          <% if (fm.photo_path) { %>
            <div class="family-photo">
              <img src="<%= imageUrl(fm.photo_path) %>" alt="<%= fm.name %>" loading="lazy">
            </div>
          <% } else { %>
            <div class="family-photo placeholder"><%= fm.emoji || '&#128100;' %></div>
          <% } %>
          <div class="family-card-body">
            <div class="family-card-name"><%= fm.name %></div>
            <div class="family-card-relation"><%= fm.relation %></div>
            <p class="family-card-bio">Tap to read more.</p>
          </div>
        </div>
      <% }); %>
    </div>
  <% } %>

  <% if (grandparents.length) { %>
    <div class="family-section-title">&#10022; Grandparents</div>
    <div class="family-cards">
      <% grandparents.forEach(fm => { %>
        <div class="family-card" onclick="openFamilyDetail('<%= fm.member_key %>')">
          <% if (fm.photo_path) { %>
            <div class="family-photo">
              <img src="<%= imageUrl(fm.photo_path) %>" alt="<%= fm.name %>" loading="lazy">
            </div>
          <% } else { %>
            <div class="family-photo placeholder"><%= fm.emoji || '&#128100;' %></div>
          <% } %>
          <div class="family-card-body">
            <div class="family-card-name"><%= fm.name %></div>
            <div class="family-card-relation"><%= fm.relation %></div>
            <p class="family-card-bio">Tap to read more.</p>
          </div>
        </div>
      <% }); %>
    </div>
  <% } %>
</section>

<!-- Family Member Detail Panel -->
<div id="family-detail">
  <div class="fdetail-hero">
    <div id="fdetail-img-wrap"></div>
    <div class="fdetail-hero-overlay"></div>
    <button class="fdetail-back" onclick="closeFamilyDetail()">&#8592; Back to Family</button>
    <div class="fdetail-hero-text">
      <div class="fdetail-relation" id="fdetail-relation"></div>
      <div class="fdetail-name" id="fdetail-name"></div>
    </div>
  </div>
  <div class="fdetail-body">
    <div class="fdetail-meta" id="fdetail-meta"></div>
    <div class="fdetail-story-label">&#10022; Their Story</div>
    <div class="fdetail-story" id="fdetail-story"></div>
    <div class="fdetail-quote" id="fdetail-quote"></div>
    <div class="fdetail-story" id="fdetail-story2"></div>
    <div class="fdetail-photos" id="fdetail-photos"></div>
  </div>
</div>
